## Управление базой через psql
При установке PostgreSQL был автоматически создан суперпользователь *postgres*. У него есть полные права на управление базами данных.

Поуправляем немного.

В командной строке от имени пользователя postgres вызовите утилиту **psql**, это программа-клиент для подключения и управления СУБД:
```shell
sudo -u postgres psql
```

Утилита **psql** запущена, в ней вы можете выполнять SQL-команды для работы с базами данных.
Приглашение для ввода команд в psql выглядит так: `postgres=#`.

На одном сервере *Postgres* может работать несколько независимых баз данных.
Вызвать список всех баз, которые есть на сервере, можно командой `\l`. Выполните её:
```shell
\l

# выйти обратно можно с помощью клавиши q
```
**psql** отобразит перечень и описание баз.

По умолчанию при установке *Postgres* создаются три системные базы данных: `postgres`, `template0` и `template1`.
Для работы с проектом вы создадите собственную базу, и она тоже появится в этом списке.

Вот ещё несколько служебных команд **psql**:
```shell
\? # справка по командам консольного клиента psql
\h # справка по доступным командам SQL
\h <команда> # справка по конкретной команде
\l # список баз данных
\du # список пользователей
\dt # список таблиц
\q # выйти
```

## Создание базы данных и пользователя
Теперь через **psql** создайте базу данных с именем `yatube`:
```shell
CREATE DATABASE yatube;
# при успешном создании вернется CREATE DATABASE
```
Для взаимодействия с базой данных ваш Django-проект будет обращаться с запросами к серверу базы данных.
Для этого Django должен иметь право доступа на этот сервер, «быть залогиненным» на этом сервере.

Создайте через **psql** пользователя и дайте ему нужные права:
```shell
-- создайте пользователя yatube_user и придумайте свой пароль, посложнее, чем в примере
CREATE USER yatube_user WITH ENCRYPTED PASSWORD 'xxxyyyzzz'; 
-- дайте пользователю yatube_user все права при работе с базой yatube 
GRANT ALL PRIVILEGES ON DATABASE yatube TO yatube_user; 
```

Проверьте, создалась ли база: выполните команду `\l`. Новая база отобразится в списке.

Чтобы выйти из **psql**, выполните команду `\q`.
Вы всё ещё работаете под пользователем `postgres`.
Выполните команду `exit`: вы снова окажетесь под своим пользователем.

## Резервное копирование базы данных (бэкапы)
Администраторы серверов делятся на тех кто не делает бэкапы и тех, кто **уже** делает.

Потеря данных из базы — одно из самых печальных и непоправимых событий, которые могут приключиться. Программные файлы, код, систему — всё это можно восстановить, но как вернуть, например, базу клиентов, накопленную за несколько лет?

Не ждите повода: создавайте резервные копии данных, чтобы в любой момент можно было их восстановить. Это можно сделать с помощью встроенной утилиты **pg_dump**:

```shell
sudo -u postgres pg_dump yatube > yatube_backup.dump
```

Эта команда создаст файл («дамп базы») **yatube_backup.dump** с бэкапом данных из БД **yatube**.
В файле будут сохранены все данные из базы и команды, выполнение которых создаст копию исходной БД.

```shell
sudo -u postgres psql  createdb yatube2 # создали пустую базу данных с именем yatube2
sudo -u postgres psql -d yatube2 -f yatube_backup.dump # загрузили в неё данные из дампа
```
